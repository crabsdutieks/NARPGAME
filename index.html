<!DOCTYPE html><html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>SADE • Drift</title>
  <meta name="description" content="A small surreal web game. Tap/click to invert gravity. Built as a single-file static app for GitHub + Vercel." />
  <style>
    :root{
      --ink:#0e0f17;
      --bg0:#070912;
      --bg1:#0a0e1e;
      --bg2:#121a36;
      --mist:#a9b0ff;
      --rose:#ff6ea8;
      --teal:#42ffd4;
      --violet:#9b8cff;
      --gold:#ffd166;
      --soft:#c9d1ff;
    }html,body{
  margin:0; padding:0; height:100%; background:var(--bg0); color:#e9ecff; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
}

/* Layout */
#wrap{ position:fixed; inset:0; display:grid; grid-template-rows: 1fr; }
canvas{ position:absolute; inset:0; width:100%; height:100%; display:block; background: radial-gradient(120vmax 120vmax at 20% 20%, var(--bg2), transparent 40%),
                                       radial-gradient(120vmax 120vmax at 80% 80%, #191e3d, transparent 40%),
                                       linear-gradient(180deg, var(--bg1), var(--bg0)); }

/* UI */
.ui{ position:relative; z-index:3; display:flex; align-items:center; justify-content:center; }
.panel{ width:min(92vw,720px); backdrop-filter: blur(10px); background: color-mix(in oklab, #ffffff 8%, transparent 92%); border:1px solid color-mix(in oklab, #ffffff 12%, transparent 88%); border-radius:20px; padding:24px; box-shadow: 0 20px 60px rgba(0,0,0,.35); }
.title{ font-weight:800; letter-spacing:.08em; text-transform:uppercase; font-size: clamp(22px, 5vw, 36px); opacity:.95 }
.subtitle{ opacity:.8; margin:.25rem 0 1rem; font-size: clamp(12px, 2.5vw, 14px); }

.row{ display:flex; gap:12px; flex-wrap:wrap; margin-top:14px; }
button, .btn{ appearance:none; border:none; cursor:pointer; background:linear-gradient(180deg, #1b2144, #10142d); color:#eaeaff; padding:12px 16px; border-radius:14px; font-weight:700; letter-spacing:.04em; box-shadow: inset 0 1px 0 rgba(255,255,255,.06), 0 6px 18px rgba(0,0,0,.25); transition: transform .08s ease, box-shadow .2s ease, opacity .2s ease; }
button:active{ transform: translateY(1px) scale(.99); }
.ghost{ background:rgba(255,255,255,.05); border:1px solid rgba(255,255,255,.08) }

.kv{ display:flex; gap:10px; align-items:center; justify-content:space-between; padding:10px 12px; background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.06); border-radius:12px; }
.switch{ display:inline-flex; align-items:center; gap:10px; }
.switch input{ width:44px; height:26px; appearance:none; background:#232a4f; border-radius:999px; position:relative; outline:none; box-shadow: inset 0 2px 6px rgba(0,0,0,.35); }
.switch input::after{ content:""; position:absolute; top:3px; left:3px; width:20px; height:20px; border-radius:50%; background:#b7c1ff; transition:left .2s ease; box-shadow: 0 2px 6px rgba(0,0,0,.35); }
.switch input:checked{ background:#2a6a62 }
.switch input:checked::after{ left:21px; background:#d6fff7 }

.hud{ position:absolute; inset:0; pointer-events:none; z-index:2; font-weight:700; letter-spacing:.06em; }
.hud .top{ position:absolute; top: env(safe-area-inset-top, 12px); left:12px; right:12px; display:flex; justify-content:space-between; gap:10px; }
.badge{ background:rgba(0,0,0,.35); padding:8px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.08); box-shadow:0 6px 16px rgba(0,0,0,.35); }

.hidden{ display:none !important; }

a, .link{ color:var(--teal); text-decoration:none; }
a:hover{ text-decoration:underline; }

/* Touch hint */
.hint{ position:absolute; left:50%; bottom: env(safe-area-inset-bottom, 24px); transform:translateX(-50%); opacity:.75; font-size:14px; padding:8px 12px; border-radius:999px; background:rgba(0,0,0,.35); border:1px solid rgba(255,255,255,.08) }

/* Game over */
.modal{ position:absolute; inset:0; z-index:4; display:grid; place-items:center; background: radial-gradient(60vmax 60vmax at 50% 40%, rgba(6,8,18,.4), rgba(6,8,18,.8)); backdrop-filter: blur(4px); }
.modal .panel{ text-align:center }

  </style>
</head>
<body>
<div id="wrap">
  <canvas id="game"></canvas>  <!-- HUD -->  <div class="hud" id="hud">
    <div class="top">
      <div class="badge" id="score">0</div>
      <div class="badge" id="high">HI 0</div>
    </div>
    <div class="hint" id="hint">Tap / Click to invert gravity</div>
  </div>  <!-- Main Menu -->  <div class="ui" id="menu">
    <div class="panel">
      <div class="title">SADE • DRIFT</div>
      <div class="subtitle">A small, melancholic runner set in a soft void. You are an eye that remembers. Avoid the empties, collect the shards.</div>
      <div class="row">
        <button id="btnStart">Start</button>
        <button id="btnOptions" class="ghost">Options</button>
        <button id="btnCredits" class="ghost">Credits</button>
      </div>
    </div>
  </div>  <!-- Options -->  <div class="ui hidden" id="options">
    <div class="panel">
      <div class="title">Options</div>
      <div class="row">
        <div class="kv" style="flex:1 1 240px">
          <div>Music</div>
          <label class="switch"><input id="optMusic" type="checkbox" checked></label>
        </div>
        <div class="kv" style="flex:1 1 240px">
          <div>SFX</div>
          <label class="switch"><input id="optSfx" type="checkbox" checked></label>
        </div>
        <div class="kv" style="flex:1 1 240px">
          <div>Particles</div>
          <label class="switch"><input id="optFx" type="checkbox" checked></label>
        </div>
      </div>
      <div class="row">
        <button id="btnBack">Back</button>
        <button id="btnReset" class="ghost">Reset High Score</button>
      </div>
    </div>
  </div>  <!-- Credits -->  <div class="ui hidden" id="credits">
    <div class="panel">
      <div class="title">Credits</div>
      <p>Design & code: You × OMNI-DEV ∞ SINGULARITY. Single-file, static, Vercel-ready.</p>
      <div class="row"><button id="btnBack2">Back</button></div>
    </div>
  </div>  <!-- Game Over Modal -->  <div class="modal hidden" id="over">
    <div class="panel">
      <div class="title">You dissolved</div>
      <div class="subtitle" id="stats">—</div>
      <div class="row" style="justify-content:center">
        <button id="btnAgain">Again</button>
        <a id="share" class="btn" href="#" target="_blank" rel="noopener">Share</a>
        <button id="btnMenu" class="ghost">Menu</button>
      </div>
    </div>
  </div>
</div><script>
(function(){
  'use strict';

  // ------ Helpers ------
  const clamp = (v, a, b)=> Math.max(a, Math.min(b, v));
  const rand = (a=1,b=0)=> Math.random()*(a-b)+b;
  const lerp = (a,b,t)=> a+(b-a)*t;

  // Time
  let then=0, now=0, dt=0, t=0;

  // Canvas & sizing
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');
  const DPR = Math.max(1, Math.min(2, window.devicePixelRatio||1));
  let W=0, H=0;
  function resize(){
    W = Math.floor(window.innerWidth);
    H = Math.floor(window.innerHeight);
    canvas.width = W*DPR; canvas.height = H*DPR;
    canvas.style.width = W+'px'; canvas.style.height = H+'px';
    ctx.setTransform(DPR,0,0,DPR,0,0);
  }
  window.addEventListener('resize', resize, {passive:true});
  resize();

  // ------ State ------
  const hud = {
    score: document.getElementById('score'),
    high: document.getElementById('high'),
    hint: document.getElementById('hint')
  };
  const ui = {
    menu: document.getElementById('menu'),
    options: document.getElementById('options'),
    credits: document.getElementById('credits'),
    over: document.getElementById('over'),
    stats: document.getElementById('stats'),
    share: document.getElementById('share')
  };

  const buttons = {
    start: document.getElementById('btnStart'),
    options: document.getElementById('btnOptions'),
    credits: document.getElementById('btnCredits'),
    back: document.getElementById('btnBack'),
    back2: document.getElementById('btnBack2'),
    again: document.getElementById('btnAgain'),
    menu: document.getElementById('btnMenu'),
    reset: document.getElementById('btnReset')
  };

  const opts = {
    music: document.getElementById('optMusic'),
    sfx: document.getElementById('optSfx'),
    fx: document.getElementById('optFx')
  };

  const storeKey = 'sadeHighScore';
  let high = Number(localStorage.getItem(storeKey)||0);
  hud.high.textContent = `HI ${high}`;

  // ------ Audio (created on first user gesture) ------
  let AC=null, master=null, musicGain=null, sfxGain=null, musicNodes=[];
  function initAudio(){
    if (AC) return;
    try{
      AC = new (window.AudioContext||window.webkitAudioContext)();
      master = AC.createGain(); master.gain.value = 0.9; master.connect(AC.destination);
      musicGain = AC.createGain(); musicGain.gain.value = opts.music.checked?0.25:0; musicGain.connect(master);
      sfxGain = AC.createGain(); sfxGain.gain.value = opts.sfx.checked?0.6:0; sfxGain.connect(master);
      // Gentle dual-oscillator pad
      const o1 = AC.createOscillator(); o1.type='sine'; o1.frequency.value=110; const g1 = AC.createGain(); g1.gain.value=0.0; o1.connect(g1).connect(musicGain); o1.start();
      const o2 = AC.createOscillator(); o2.type='triangle'; o2.frequency.value=220; const g2 = AC.createGain(); g2.gain.value=0.0; o2.connect(g2).connect(musicGain); o2.start();
      musicNodes = [{osc:o1,g:g1},{osc:o2,g:g2}];
      // Slow envelopes
      let phase=0; function mod(){
        phase += 0.016;
        const a = (Math.sin(phase*0.25)+1)/2; // 0..1
        const b = (Math.sin(phase*0.33+1.7)+1)/2;
        g1.gain.setTargetAtTime(0.06*a, AC.currentTime, 0.5);
        g2.gain.setTargetAtTime(0.04*b, AC.currentTime, 0.5);
        o1.frequency.setTargetAtTime(95+8*Math.sin(phase*0.17), AC.currentTime, 0.5);
        o2.frequency.setTargetAtTime(190+10*Math.sin(phase*0.13+1.3), AC.currentTime, 0.5);
        musicRAF = requestAnimationFrame(mod);
      }
      musicRAF = requestAnimationFrame(mod);
    }catch(e){ console.warn('Audio init failed', e); }
  }
  let musicRAF = null;

  function setMusic(val){ if(musicGain) musicGain.gain.value = val?0.25:0; }
  function setSfx(val){ if(sfxGain) sfxGain.gain.value = val?0.6:0; }

  function blip(freq=440, dur=0.08){
    if(!AC || !sfxGain) return; const o=AC.createOscillator(); const g=AC.createGain(); o.type='sine'; o.frequency.value=freq; g.gain.value=0.001; o.connect(g).connect(sfxGain); o.start(); g.gain.exponentialRampToValueAtTime(0.5, AC.currentTime+0.01); g.gain.exponentialRampToValueAtTime(0.0001, AC.currentTime+dur); o.stop(AC.currentTime+dur);
  }
  function thud(){ if(!AC||!sfxGain) return; const o=AC.createOscillator(); const g=AC.createGain(); o.type='sawtooth'; o.frequency.value=70; g.gain.value=0.001; o.connect(g).connect(sfxGain); o.start(); g.gain.exponentialRampToValueAtTime(0.6, AC.currentTime+0.01); o.frequency.exponentialRampToValueAtTime(30, AC.currentTime+0.18); g.gain.exponentialRampToValueAtTime(0.0001, AC.currentTime+0.22); o.stop(AC.currentTime+0.25); }

  // ------ Game objects ------
  const state = { playing:false, dead:false, score:0, dist:0, gravity:1 };

  const player = {
    x: 120, y: 0, r: 14, vy: 0, ay: 800,
    draw(){
      // Eye
      ctx.save();
      ctx.translate(this.x, this.y);
      const tilt = clamp(this.vy/400, -0.5, 0.5);
      ctx.rotate(tilt*0.2);
      // sclera
      const R = this.r;
      const grd = ctx.createRadialGradient(0,-R*0.2, R*0.2, 0,0,R);
      grd.addColorStop(0, 'rgba(255,255,255,0.95)');
      grd.addColorStop(1, 'rgba(230,235,255,0.15)');
      ctx.fillStyle = grd;
      ctx.beginPath(); ctx.ellipse(0,0,R*1.4,R,0,0,Math.PI*2); ctx.fill();
      // iris
      ctx.fillStyle = '#9b8cff'; ctx.beginPath(); ctx.arc(0,0,R*0.6,0,Math.PI*2); ctx.fill();
      // pupil
      ctx.fillStyle = '#0b0b16'; ctx.beginPath(); ctx.arc(0,0,R*0.28,0,Math.PI*2); ctx.fill();
      // tear
      const tearY = lerp(-R*0.1, R*0.8, (Math.sin(t*0.002)+1)/2);
      ctx.fillStyle = 'rgba(66,255,212,0.85)';
      ctx.beginPath(); ctx.ellipse(R*0.6, tearY, 3, 6, 0, 0, Math.PI*2); ctx.fill();
      ctx.restore();
    },
    update(dt){
      this.vy += this.ay * state.gravity * dt;
      this.y += this.vy * dt;
      // drag
      this.vy *= 0.996;
      // boundaries
      if (this.y < this.r){ this.y = this.r; this.vy = Math.abs(this.vy)*0.5; }
      if (this.y > H-this.r){ this.y = H-this.r; this.vy = -Math.abs(this.vy)*0.5; }
    }
  };

  function reset(){
    state.playing = false; state.dead=false; state.score=0; state.dist=0; state.gravity=1;
    player.y = H/2; player.vy = 0;
    shards.length = 0; voids.length = 0; fog.length=0; spawnTimer=0; spawnVoidTimer=0; fogTimer=0;
  }

  // Parallax fog
  const fog=[]; let fogTimer=0;
  function spawnFog(){
    const s = rand(0.4, 1.2);
    fog.push({ x: W+60, y: rand(40,H-40), s, a: rand(0.05,0.15), r: rand(30,110) });
  }

  // Collectibles and hazards
  const shards=[]; const voids=[]; let spawnTimer=0, spawnVoidTimer=0;
  function spawnShard(){
    shards.push({ x: W+30, y: rand(60,H-60), r: 8, v: rand(140, 220) });
  }
  function spawnVoid(){
    const gap = 120; // we carve a safe vertical slot sometimes
    const center = rand(100, H-100);
    const choice = Math.random();
    if(choice<0.5){ // simple orb
      voids.push({ x: W+50, y: center, r: rand(24, 42), v: rand(160, 240), type: 'orb' });
    }else{ // bar with a gap
      voids.push({ x: W+50, y: center-gap/2, r: rand(28, 40), v: rand(140,220), type:'bar-top', h: H });
      voids.push({ x: W+50, y: center+gap/2, r: rand(28, 40), v: rand(140,220), type:'bar-bot', h: H });
    }
  }

  // Input
  let held=false;
  function toggleGravity(){ state.gravity *= -1; player.vy *= 0.5; if(opts.sfx.checked) blip( state.gravity>0?380:520 ); }

  window.addEventListener('pointerdown', (e)=>{ held=true; if(!AC) initAudio(); if(!state.playing && !ui.menu.classList.contains('hidden')) return; toggleGravity(); });
  window.addEventListener('keydown', (e)=>{ if(e.code==='Space'||e.code==='ArrowUp'||e.code==='KeyW'){ e.preventDefault(); if(!AC) initAudio(); if(!state.playing && !ui.menu.classList.contains('hidden')) return; toggleGravity(); } });

  // UI wiring
  function show(el){ el.classList.remove('hidden'); }
  function hide(el){ el.classList.add('hidden'); }

  buttons.start.addEventListener('click', ()=>{ initAudio(); hide(ui.menu); hide(ui.options); hide(ui.credits); hide(ui.over); hud.hint.style.opacity=0.85; startGame(); });
  buttons.options.addEventListener('click', ()=>{ hide(ui.menu); show(ui.options); });
  buttons.credits.addEventListener('click', ()=>{ hide(ui.menu); show(ui.credits); });
  buttons.back.addEventListener('click', ()=>{ hide(ui.options); show(ui.menu); });
  buttons.back2.addEventListener('click', ()=>{ hide(ui.credits); show(ui.menu); });
  buttons.again.addEventListener('click', ()=>{ hide(ui.over); startGame(); });
  buttons.menu.addEventListener('click', ()=>{ hide(ui.over); show(ui.menu); });
  buttons.reset.addEventListener('click', ()=>{ high=0; localStorage.setItem(storeKey, '0'); hud.high.textContent=`HI 0`; });

  opts.music.addEventListener('change', ()=>{ setMusic(opts.music.checked); });
  opts.sfx.addEventListener('change', ()=>{ setSfx(opts.sfx.checked); });

  // Game loop
  function startGame(){
    reset(); state.playing = true; hud.score.textContent='0'; then = performance.now(); requestAnimationFrame(loop);
  }

  function loop(ts){
    if(!state.playing) return;
    now = ts; dt = Math.min(0.033, (now-then)/1000); then = now; t += dt*1000;
    update(dt); draw();
    requestAnimationFrame(loop);
  }

  function update(dt){
    // Spawn fields
    fogTimer -= dt; if(fogTimer<=0 && opts.fx.checked){ fogTimer = rand(0.4,1.2); spawnFog(); }
    spawnTimer -= dt; if(spawnTimer<=0){ spawnTimer = rand(0.6, 1.2); spawnShard(); }
    spawnVoidTimer -= dt; if(spawnVoidTimer<=0){ spawnVoidTimer = rand(0.9, 1.5); spawnVoid(); }

    // Move fog
    for(let i=fog.length-1;i>=0;i--){ const f=fog[i]; f.x -= (20 + f.s*30)*dt; if(f.x<-120) fog.splice(i,1); }

    // Move shards & collisions
    for(let i=shards.length-1;i>=0;i--){ const s=shards[i]; s.x -= s.v*dt; if(s.x<-30){ shards.splice(i,1); continue; }
      // pickup
      const dx = s.x - player.x, dy = s.y - player.y; if(dx*dx + dy*dy < (player.r + s.r)*(player.r + s.r)){
        shards.splice(i,1); state.score += 15; if(opts.sfx.checked) blip(700, 0.06); }
    }

    // Move voids & collisions
    for(let i=voids.length-1;i>=0;i--){ const v=voids[i]; v.x -= v.v*dt; if(v.x<-80){ voids.splice(i,1); continue; }
      // collision
      const dx = v.x - player.x, dy = v.y - player.y; const rr = (player.r + v.r); if(dx*dx + dy*dy < rr*rr){ die(); return; }
    }

    // Score by distance
    state.dist += 60*dt; state.score += 1*dt; hud.score.textContent = Math.floor(state.score).toString();

    // Player
    player.update(dt);

    // Slight hint fade
    hud.hint.style.opacity = lerp(parseFloat(getComputedStyle(hud.hint).opacity)||1, 0.05, 0.02);
  }

  function draw(){
    ctx.clearRect(0,0,W,H);

    // background stars
    ctx.save();
    const g = ctx.createLinearGradient(0,0,0,H);
    g.addColorStop(0, '#0a0e1e'); g.addColorStop(1, '#070912');
    ctx.fillStyle = g; ctx.fillRect(0,0,W,H);

    // distant parallax dots
    ctx.globalAlpha = 0.35; ctx.fillStyle = '#c9d1ff';
    for(let i=0;i<40;i++){ const x = (i*97 + t*0.02)%W; const y = (i*53)%H; ctx.fillRect(x, y, 1, 1); }
    ctx.globalAlpha = 1;

    // fog
    for(const f of fog){
      const rad = f.r; const gr = ctx.createRadialGradient(f.x, f.y, 10, f.x, f.y, rad);
      gr.addColorStop(0, `rgba(169,176,255,${f.a})`);
      gr.addColorStop(1, 'rgba(0,0,0,0)');
      ctx.fillStyle = gr; ctx.beginPath(); ctx.arc(f.x, f.y, rad, 0, Math.PI*2); ctx.fill();
    }

    // shards
    for(const s of shards){
      ctx.save(); ctx.translate(s.x, s.y); ctx.rotate((t*0.001)% (Math.PI*2));
      ctx.fillStyle = '#ffd166';
      ctx.beginPath(); ctx.moveTo(0,-s.r); ctx.lineTo(s.r,0); ctx.lineTo(0,s.r); ctx.lineTo(-s.r,0); ctx.closePath(); ctx.fill();
      ctx.restore();
    }

    // voids
    ctx.strokeStyle = 'rgba(255,110,168,0.8)'; ctx.lineWidth = 2; ctx.fillStyle = 'rgba(10,10,16,0.6)';
    for(const v of voids){
      if(v.type==='orb'){
        ctx.beginPath(); ctx.arc(v.x, v.y, v.r, 0, Math.PI*2); ctx.fill(); ctx.stroke();
      } else {
        const w=26; // bar thickness
        if(v.type==='bar-top'){
          ctx.beginPath(); ctx.rect(v.x-w/2, 0, w, v.y - v.r); ctx.fill(); ctx.stroke();
        } else {
          ctx.beginPath(); ctx.rect(v.x-w/2, v.y+v.r, w, H-(v.y+v.r)); ctx.fill(); ctx.stroke();
        }
      }
    }

    // player
    player.draw();

    ctx.restore();
  }

  function die(){
    if(state.dead) return; state.dead=true; state.playing=false; thud();
    const final = Math.floor(state.score);
    if(final>high){ high=final; localStorage.setItem(storeKey, String(high)); hud.high.textContent = `HI ${high}`; }
    ui.stats.textContent = `Score ${final} • Best ${high}`;
    const shareText = encodeURIComponent(`I drifted through the soft void and scored ${final} in SADE • DRIFT. Try to beat me.`);
    const url = encodeURIComponent(window.location.href);
    ui.share.href = `https://twitter.com/intent/tweet?text=${shareText}&url=${url}`;
    show(ui.over);
  }

  // Start on menu
  reset();
})();
</script></body>
</html>
