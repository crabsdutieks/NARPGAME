<!DOCTYPE html><html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>SADE • Drift (Safe Mode)</title>
  <meta name="description" content="A small surreal web game. Tap/Space to invert gravity. Minimal, stable, Vercel-ready." />
  <style>
    :root{ --bg0:#070912; --bg1:#0a0e1e; --bg2:#121a36; --rose:#ff6ea8; --teal:#42ffd4; --gold:#ffd166; }
    html,body{margin:0;padding:0;height:100%;background:var(--bg0);color:#e9ecff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;}
    #wrap{position:fixed;inset:0;display:grid;grid-template-rows:1fr}
    canvas{position:absolute;inset:0;width:100%;height:100%;display:block;background:
      radial-gradient(120vmax 120vmax at 20% 20%, var(--bg2), transparent 40%),
      radial-gradient(120vmax 120vmax at 80% 80%, #191e3d, transparent 40%),
      linear-gradient(180deg, var(--bg1), var(--bg0));}
    .hud{position:absolute;inset:0;pointer-events:none;z-index:2;font-weight:800;letter-spacing:.06em}
    .top{position:absolute;top:env(safe-area-inset-top,12px);left:12px;right:12px;display:flex;justify-content:space-between;gap:10px}
    .badge{background:rgba(0,0,0,.35);padding:8px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.10);box-shadow:0 6px 16px rgba(0,0,0,.35)}
    .hint{position:absolute;left:50%;bottom:env(safe-area-inset-bottom,24px);transform:translateX(-50%);opacity:.9;font-size:14px;padding:8px 12px;border-radius:999px;background:rgba(0,0,0,.35);border:1px solid rgba(255,255,255,.1)}
    .ui{position:relative;z-index:3;display:flex;align-items:center;justify-content:center}
    .panel{width:min(92vw,720px);backdrop-filter:blur(10px);background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);border-radius:20px;padding:24px;box-shadow:0 20px 60px rgba(0,0,0,.35)}
    .title{font-weight:900;letter-spacing:.08em;text-transform:uppercase;font-size:clamp(22px,5vw,36px)}
    .subtitle{opacity:.85;margin:.25rem 0 1rem;font-size:clamp(12px,2.6vw,14px)}
    .row{display:flex;gap:12px;flex-wrap:wrap;margin-top:14px}
    button,.btn{appearance:none;border:none;cursor:pointer;background:linear-gradient(180deg,#1b2144,#10142d);color:#eaeaff;padding:12px 16px;border-radius:14px;font-weight:800;letter-spacing:.04em;box-shadow:inset 0 1px 0 rgba(255,255,255,.06),0 6px 18px rgba(0,0,0,.25);transition:transform .08s ease,box-shadow .2s ease,opacity .2s ease}
    button:active{transform:translateY(1px) scale(.99)}
    .ghost{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08)}
    .modal{position:absolute;inset:0;z-index:4;display:grid;place-items:center;background:radial-gradient(60vmax 60vmax at 50% 40%, rgba(6,8,18,.45), rgba(6,8,18,.85))}
    .hidden{display:none!important}
    a{color:var(--teal);text-decoration:none}
    a:hover{text-decoration:underline}
  </style>
</head>
<body>
<div id="wrap">
  <canvas id="game"></canvas>  <div class="hud" id="hud">
    <div class="top">
      <div class="badge" id="score">0</div>
      <div class="badge" id="high">HI 0</div>
    </div>
    <div class="hint" id="hint">Tap / Click / Space — invert gravity (press H to show hitboxes)</div>
  </div>  <div class="ui" id="menu">
    <div class="panel">
      <div class="title">SADE • DRIFT</div>
      <div class="subtitle">Minimal base build (safe). Start works. Collisions fixed.</div>
      <div class="row">
        <button id="btnStart">Start</button>
        <button id="btnCredits" class="ghost">Credits</button>
      </div>
    </div>
  </div>  <div class="ui hidden" id="credits">
    <div class="panel">
      <div class="title">Credits</div>
      <p>Design & code: You × OMNI-DEV. Press <b>H</b> in-game for hitboxes.</p>
      <div class="row"><button id="btnBack2">Back</button></div>
    </div>
  </div>  <div class="modal hidden" id="over">
    <div class="panel" style="text-align:center">
      <div class="title">You dissolved</div>
      <div class="subtitle" id="stats">—</div>
      <div class="row" style="justify-content:center">
        <button id="btnAgain">Again</button>
        <a id="share" class="btn" href="#" target="_blank" rel="noopener">Share</a>
        <button id="btnMenu" class="ghost">Menu</button>
      </div>
    </div>
  </div>
</div><script>
(function(){
  'use strict';
  // Helpers
  const clamp=(v,a,b)=>Math.max(a,Math.min(b,v));
  const rand=(a=1,b=0)=>Math.random()*(a-b)+b;
  const lerp=(a,b,t)=>a+(b-a)*t;

  // Canvas
  const canvas=document.getElementById('game');
  const ctx=canvas.getContext('2d');
  const DPR=Math.max(1,Math.min(2,devicePixelRatio||1));
  let W=0,H=0; function resize(){ W=innerWidth|0; H=innerHeight|0; canvas.width=W*DPR; canvas.height=H*DPR; canvas.style.width=W+'px'; canvas.style.height=H+'px'; ctx.setTransform(DPR,0,0,DPR,0,0);} addEventListener('resize',resize,{passive:true}); resize();

  // UI refs
  const hud={score:document.getElementById('score'), high:document.getElementById('high'), hint:document.getElementById('hint')};
  const ui={menu:document.getElementById('menu'), credits:document.getElementById('credits'), over:document.getElementById('over'), stats:document.getElementById('stats'), share:document.getElementById('share')};
  const btn={start:document.getElementById('btnStart'), credits:document.getElementById('btnCredits'), back2:document.getElementById('btnBack2'), again:document.getElementById('btnAgain'), menu:document.getElementById('btnMenu')};

  // Storage
  const storeKey='sadeHighScore'; let high=Number(localStorage.getItem(storeKey)||0); hud.high.textContent='HI '+high;

  // Game state (base)
  const BAR_W=28; const state={playing:false,dead:false,score:0,gravity:1};
  const player={x:120,y:0,r:14,vy:0,ay:800, draw(){ ctx.save(); ctx.translate(this.x,this.y); const R=this.r; const g=ctx.createRadialGradient(0,-R*0.2,R*0.2,0,0,R); g.addColorStop(0,'rgba(255,255,255,0.95)'); g.addColorStop(1,'rgba(230,235,255,0.15)'); ctx.fillStyle=g; ctx.beginPath(); ctx.ellipse(0,0,R*1.4,R,0,0,Math.PI*2); ctx.fill(); ctx.fillStyle='#9b8cff'; ctx.beginPath(); ctx.arc(0,0,R*0.6,0,Math.PI*2); ctx.fill(); ctx.fillStyle:'#0b0b16'; ctx.beginPath(); ctx.arc(0,0,R*0.28,0,Math.PI*2); ctx.fill(); ctx.restore(); }, update(dt){ this.vy+=this.ay*state.gravity*dt; this.y+=this.vy*dt; this.vy*=0.996; if(this.y<this.r){ this.y=this.r; this.vy=Math.abs(this.vy)*0.5; } if(this.y>H-this.r){ this.y=H-this.r; this.vy=-Math.abs(this.vy)*0.5; } } };

  const fog=[], shards=[], voids=[]; let fogTimer=0, spawnTimer=0, spawnVoidTimer=0, t=0; let showHit=false;
  function spawnFog(){ const s=rand(0.4,1.2); fog.push({x:W+60,y:rand(40,H-40),s, a:rand(0.05,0.15), r:rand(30,110)}); }
  function spawnShard(){ shards.push({x:W+40,y:rand(60,H-60),r:8,v:rand(140,220)}); }
  function spawnVoid(){ const gap=120, center=rand(100,H-100), choice=Math.random(); if(choice<0.55){ voids.push({x:W+90,y:center,r:rand(24,42),v:rand(160,240),type:'orb'}); } else { const r=rand(28,40); voids.push({x:W+90,y:center-gap/2,r,v:rand(140,220),type:'bar-top'}); voids.push({x:W+90,y:center+gap/2,r,v:rand(140,220),type:'bar-bot'}); } }

  // Input during play only
  function gameplayPointer(e){ toggleGravity(); }
  function gameplayKey(e){ if(e.code==='Space'||e.code==='ArrowUp'||e.code==='KeyW'){ e.preventDefault(); toggleGravity(); } if(e.code==='KeyH'){ showHit=!showHit; } }
  function attachPlayInputs(){ canvas.addEventListener('pointerdown',gameplayPointer); addEventListener('keydown',gameplayKey); }
  function detachPlayInputs(){ canvas.removeEventListener('pointerdown',gameplayPointer); removeEventListener('keydown',gameplayKey); }

  function toggleGravity(){ state.gravity*=-1; player.vy*=0.5; }

  // UI wiring
  function show(el){ el.classList.remove('hidden'); }
  function hide(el){ el.classList.add('hidden'); }
  btn.start.addEventListener('click',()=>{ hide(ui.menu); hide(ui.credits); hide(ui.over); startGame(); });
  btn.credits.addEventListener('click',()=>{ hide(ui.menu); show(ui.credits); });
  btn.back2.addEventListener('click',()=>{ hide(ui.credits); show(ui.menu); });
  btn.again.addEventListener('click',()=>{ hide(ui.over); startGame(); });
  btn.menu.addEventListener('click',()=>{ hide(ui.over); show(ui.menu); });

  // Loop
  let then=performance.now();
  function startGame(){ state.playing=true; state.dead=false; state.score=0; state.gravity=1; player.y=H/2; player.vy=0; fog.length=0; shards.length=0; voids.length=0; fogTimer=0; spawnTimer=0; spawnVoidTimer=0; then=performance.now(); attachPlayInputs(); requestAnimationFrame(loop); }
  function stopGame(){ state.playing=false; detachPlayInputs(); }

  function loop(ts){ if(!state.playing) return; const dt=Math.min(0.033,(ts-then)/1000); then=ts; t+=dt*1000; update(dt); draw(); requestAnimationFrame(loop); }

  function update(dt){
    // Spawns
    fogTimer-=dt; if(fogTimer<=0){ fogTimer=rand(0.4,1.2); spawnFog(); }
    spawnTimer-=dt; if(spawnTimer<=0){ spawnTimer=rand(0.6,1.2); spawnShard(); }
    spawnVoidTimer-=dt; if(spawnVoidTimer<=0){ spawnVoidTimer=rand(0.9,1.5); spawnVoid(); }

    // Move fog
    for(let i=fog.length-1;i>=0;i--){ const f=fog[i]; f.x-=(20+f.s*30)*dt; if(f.x<-120) fog.splice(i,1); }

    // Move shards + pickup
    for(let i=shards.length-1;i>=0;i--){ const s=shards[i]; s.x-=s.v*dt; if(s.x<-30){ shards.splice(i,1); continue; }
      const dx=s.x-player.x, dy=s.y-player.y; if(dx*dx+dy*dy<(player.r+s.r)*(player.r+s.r)){ shards.splice(i,1); state.score+=15; }
    }

    // Circle-rect collision
    function circleRect(cx,cy,cr,rx,ry,rw,rh){ const nx=clamp(cx,rx,rx+rw), ny=clamp(cy,ry,ry+rh); const dx=cx-nx, dy=cy-ny; return (dx*dx+dy*dy)<=cr*cr; }

    // Move voids + collisions
    for(let i=voids.length-1;i>=0;i--){ const v=voids[i]; v.x-=v.v*dt; if(v.x<-80){ voids.splice(i,1); continue; }
      let hit=false; if(v.type==='orb'){ const dx=v.x-player.x, dy=v.y-player.y; const rr=player.r+v.r; hit=(dx*dx+dy*dy)<rr*rr; }
      else if(v.type==='bar-top'){ const rx=v.x-BAR_W/2, ry=0, rw=BAR_W, rh=Math.max(0, v.y - v.r); hit=circleRect(player.x,player.y,player.r,rx,ry,rw,rh); }
      else if(v.type==='bar-bot'){ const rx=v.x-BAR_W/2, ry=v.y+v.r, rw=BAR_W, rh=Math.max(0, H-(v.y+v.r)); hit=circleRect(player.x,player.y,player.r,rx,ry,rw,rh); }
      if(hit){ die(); return; }
    }

    // Score + player
    state.score += 1*dt; hud.score.textContent = Math.floor(state.score);
    player.update(dt);

    // Fade hint
    hud.hint.style.opacity = lerp(parseFloat(getComputedStyle(hud.hint).opacity)||1, 0.05, 0.02);
  }

  function draw(){
    ctx.clearRect(0,0,W,H);

    // stars
    ctx.save(); ctx.globalAlpha=0.35; ctx.fillStyle='#c9d1ff'; for(let i=0;i<40;i++){ const x=(i*97 + t*0.02)%W; const y=(i*53)%H; ctx.fillRect(x,y,1,1); } ctx.globalAlpha=1; ctx.restore();

    // fog
    for(const f of fog){ const gr=ctx.createRadialGradient(f.x,f.y,10,f.x,f.y,f.r); gr.addColorStop(0,`rgba(169,176,255,${f.a})`); gr.addColorStop(1,'rgba(0,0,0,0)'); ctx.fillStyle=gr; ctx.beginPath(); ctx.arc(f.x,f.y,f.r,0,Math.PI*2); ctx.fill(); }

    // shards
    for(const s of shards){ ctx.save(); ctx.translate(s.x,s.y); ctx.rotate((t*0.001)%(Math.PI*2)); ctx.fillStyle=varGold; ctx.beginPath(); ctx.moveTo(0,-s.r); ctx.lineTo(s.r,0); ctx.lineTo(0,s.r); ctx.lineTo(-s.r,0); ctx.closePath(); ctx.fill(); ctx.restore(); }

    // voids
    ctx.strokeStyle='rgba(255,110,168,0.8)'; ctx.lineWidth=2; ctx.fillStyle='rgba(10,10,16,0.6)';
    for(const v of voids){ if(v.type==='orb'){ ctx.beginPath(); ctx.arc(v.x,v.y,v.r,0,Math.PI*2); ctx.fill(); ctx.stroke(); if(showHit){ debugCircle(v.x,v.y,v.r,'#ff6ea8'); } }
      else { const rx=v.x-BAR_W/2; if(v.type==='bar-top'){ ctx.beginPath(); ctx.rect(rx,0,BAR_W,Math.max(0, v.y-v.r)); ctx.fill(); ctx.stroke(); if(showHit){ debugRect(rx,0,BAR_W,Math.max(0, v.y-v.r),'#ff6ea8'); }}
             else { ctx.beginPath(); ctx.rect(rx, v.y+v.r, BAR_W, Math.max(0, H-(v.y+v.r))); ctx.fill(); ctx.stroke(); if(showHit){ debugRect(rx, v.y+v.r, BAR_W, Math.max(0, H-(v.y+v.r)),'#ff6ea8'); }} }
    }

    // player
    player.draw(); if(showHit){ debugCircle(player.x,player.y,player.r,'#42ffd4'); }
  }

  // Debug helpers
  const varGold='#ffd166';
  function debugCircle(x,y,r,col){ ctx.setLineDash([4,3]); ctx.strokeStyle=col; ctx.beginPath(); ctx.arc(x,y,r,0,Math.PI*2); ctx.stroke(); ctx.setLineDash([]); }
  function debugRect(x,y,w,h,col){ ctx.setLineDash([4,3]); ctx.strokeStyle=col; ctx.strokeRect(x,y,w,h); ctx.setLineDash([]); }

  function die(){ if(state.dead) return; state.dead=true; stopGame(); const final=Math.floor(state.score); let high=Number(localStorage.getItem(storeKey)||0); if(final>high){ high=final; localStorage.setItem(storeKey,String(high)); } hud.high.textContent='HI '+high; ui.stats.textContent=`Score ${final} • Best ${high}`; const shareText=encodeURIComponent(`I drifted through the soft void and scored ${final} in SADE • DRIFT.`); const url=encodeURIComponent(location.href); ui.share.href=`https://twitter.com/intent/tweet?text=${shareText}&url=${url}`; show(ui.over); }

  // Boot state
  player.y=H/2; player.vy=0;
  show(ui.menu);
})();
</script></body>
</html>
